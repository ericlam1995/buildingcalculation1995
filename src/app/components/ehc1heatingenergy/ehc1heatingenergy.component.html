<div class="row">
  <button class="btn btn-primary" (click)="returntoSchedule()">Return to Schedule</button>
  <button class="btn btn-primary" (click)="downloadresult()">Download Result</button>
  <div class="col-md-12" id="content">

    <!-- <button class="btn btn-primary" (click)="doublecheck()">Return to Schedule</button> -->
    <h1>Building Info</h1>
    <table class="table table-sm table-bordered">
      <tr>
        <td>Project ID</td>
        <td *ngIf="designobject">{{designobject.ProjectID}}</td>
      </tr>
      <tr>
        <td>Targeting</td>
        <td *ngIf="designobject">{{targeting}}</td>
      </tr>
      <tr>
        <td>Completed By (Name)</td>
        <td *ngIf="designobject">{{designobject.CompletedBy}}</td>
      </tr>
      <tr>
        <td>Drawing Set</td>
        <td *ngIf="designobject">{{designobject.DrawingSet}}</td>
      </tr>
      <tr>
        <td>Typology / Dwelling</td>
        <td *ngIf="designobject">{{designobject.Typology}}</td>
      </tr>
      <tr>
        <td>Floor Area (ICA)</td>
        <td *ngIf="designobject">{{designobject.FloorArea}}</td>
      </tr>
      <tr>
        <td>Location</td>
        <td *ngIf="designobject">{{location}}</td>
      </tr>
      <tr>
        <td>Climate Zone</td>
        <td>{{climatezone}}</td>
      </tr>
    </table>


    <h1 style="text-align: center">Heat Loss Result</h1>
    <div class="row">
      <div class="col-md-6 roof" *ngIf="rooflist.length !== 0">
        <h1 style="text-align: center">Roof (Proposed Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Roof Name (ID)</th>
            <th># of Inclusions</th>
            <th>Roof Area</th>
            <th>Roof R-Value (Proposed)</th>
            <th>Roof Heatloss</th>
          </tr>
          <tr *ngFor="let i of rooflist">
            <td>{{i.roofname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="rooflist.length !== 0"></div>
      <div class="col-md-5 roofschedule" *ngIf="rooflist.length !== 0">
        <h1 style="text-align: center">Roof (Reference Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Roof Area</th>
            <th>Roof R-Value (Schedule Method)</th>
            <th>Roof Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of rooflist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{roofrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / roofrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / roofrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / roofrvalue)">
            </td>
          </tr>
        </table>
      </div>
      <div class="col-md-6 skylight" *ngIf="skylightlist.length !== 0">
        <h1 style="text-align: center">Skylights (Proposed Dwelling)</h1>
        <table class="table table-sm table-bordered" *ngIf="skylightlist.length > 0">
          <tr>
            <th>Skylights Name (ID)</th>
            <th># of Inclusions</th>
            <th>Skylights Area</th>
            <th>Skylights R-Value (Proposed)</th>
            <th>Skylights Heatloss</th>
          </tr>
          <tr *ngFor="let i of skylightlist">
            <td>{{i.skylightname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="skylightlist.length !== 0"></div>
      <div class="col-md-5 skylightschedule" *ngIf="skylightlist.length !== 0">
        <h1 style="text-align: center">Skylight (Reference Dwelling)</h1>
        <table class="table table-sm table-bordered" *ngIf="skylightlist.length > 0">
          <tr>
            <th>Skylights Area</th>
            <th>Skylights R-Value (Schedule Method)</th>
            <th>Skylights Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of skylightlist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{skylightrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / skylightrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / skylightrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / skylightrvalue)">
            </td>
          </tr>
        </table>
      </div>
      <div class="col-md-6 window" *ngIf="windowlist.length !== 0">
        <h1 style="text-align: center">Window (Proposed Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Window Name (ID)</th>
            <th># of Inclusions</th>
            <th>Window Area</th>
            <th>Window R-Value (Proposed)</th>
            <th>Window Heatloss</th>
          </tr>
          <tr *ngFor="let i of windowlist">
            <td>{{i.windowname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="windowlist.length !== 0"></div>
      <div class="col-md-5 windowschedule" *ngIf="windowlist.length !== 0">
        <h1 style="text-align: center">Windows (Reference Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Window Area</th>
            <th>Window R-Value (Schedule Method)</th>
            <th>Window Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of windowlist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{windowrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / windowrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / windowrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / windowrvalue)">
            </td>
          </tr>
        </table>
      </div>
      <div class="col-md-6 wall" *ngIf="walllist.length !== 0">
        <h1 style="text-align: center">Wall (Proposed Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Wall Name (ID)</th>
            <th># of Inclusions</th>
            <th>Wall Area</th>
            <th>Wall R-Value (Proposed)</th>
            <th>Wall Heatloss</th>
          </tr>
          <tr *ngFor="let i of walllist">
            <td>{{i.wallname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="walllist.length !== 0"></div>
      <div class="col-md-5 wallschedule" *ngIf="walllist.length !== 0">
        <h1 style="text-align: center">Wall (Reference Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Wall Area</th>
            <th>Wall R-Value (Schedule Method)</th>
            <th>Wall Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of walllist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{wallrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / wallrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / wallrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / wallrvalue)">
            </td>
          </tr>
        </table>
      </div>
      <div class="col-md-6 floor" *ngIf="floorlist.length !== 0">
        <h1 style="text-align: center">Floor (Proposed Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Floor Name (ID)</th>
            <th># of Inclusions</th>
            <th>Floor Area</th>
            <th>Floor R-Value (Proposed)</th>
            <th>Floor Heatloss</th>
          </tr>
          <tr *ngFor="let i of floorlist">
            <td>{{i.floorname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="floorlist.length !== 0"></div>
      <div class="col-md-5 floorschedule" *ngIf="floorlist.length !== 0">
        <h1 style="text-align: center">Floor (Reference Dwelling)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Floor Area</th>
            <th>Floor R-Value (Schedule Method)</th>
            <th>Floor Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of floorlist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{floorrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / floorrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / floorrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / floorrvalue)">
            </td>
          </tr>
        </table>
      </div>
      <div class="col-md-6 door" *ngIf="doordistinct.length !== 0">
        <h1 style="text-align: center">Door (Proposed)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Door Name (ID)</th>
            <th># of Inclusions</th>
            <th>Door Area</th>
            <th>Door R-Value</th>
            <th>Door Heatloss</th>
          </tr>
          <tr *ngFor="let i of doorlist">
            <td>{{i.doorname}}</td>
            <td>{{i.numinclusion | number: '1.0-2'}}</td>
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{i.totalrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalheatloss | number: '1.0-2'}}</td>
          </tr>
        </table>
      </div>
      <div class="col-md-1" *ngIf="doordistinct.length !== 0">
      </div>
      <div class="col-md-5 door" *ngIf="doordistinct.length !== 0">
        <h1 style="text-align: center">Door (Schedule)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Door Area</th>
            <th>Door R-Value (Schedule Method)</th>
            <th>Door Heatloss</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr *ngFor="let i of doorlist">
            <td>{{i.totalarea | number: '1.0-2'}}</td>
            <td>{{wallrvalue | number: '1.0-2'}}</td>
            <td>{{i.totalarea / wallrvalue | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="(i.totalarea / wallrvalue) >= (i.totalarea / i.totalrvalue)">
              <img src="../../../assets/pic/fail.png"
                *ngIf="(i.totalarea / i.totalrvalue) > (i.totalarea / wallrvalue)">
            </td>
          </tr>
        </table>
      </div>

      <div class="col-md-12">

        <table class="table table-sm table-bordered">
          <tr>
            <th>Total Door Area</th>
            <td>{{totalareadoor | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <th>Door Allowance (6%)</th>
            <td>{{0.06 * (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <th>Door Allowance (6m2)</th>
            <td>6</td>
          </tr>
          <tr>
            <th>Max. Door Area Allowed</th>
            <td>{{maxdoorareaallow | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <th>Assign Doors to Walls?</th>
            <td>{{maxdoorareaallow >= totalareadoor ? "Yes": "No"}}</td>
          </tr>
        </table>
      </div>


      <div class="col-md-12">
        <h1 style="text-align: center">Building Reference</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <td>{{targeting}}</td>
            <td>Schedule Method Minimum R-value Requirements (including thermal bridging)</td>
          </tr>
          <tr>
            <th>Building Element</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <th *ngFor="let i of schedulemethod">{{i.climatezone}}</th>
                </tr>
              </table>
            </th>
          </tr>
          <tr>
            <th>Roof</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <td *ngFor="let i of schedulemethod">{{i.constructionrvalue.Roof}}
                  </td>
                </tr>
              </table>
            </th>
          </tr>
          <tr>
            <th>Wall</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <td *ngFor="let i of schedulemethod">{{i.constructionrvalue.Wall}}
                  </td>
                </tr>
              </table>
            </th>
          </tr>
          <tr>
            <th>Glazing</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <td *ngFor="let i of schedulemethod">{{i.constructionrvalue.Window}}
                  </td>
                </tr>
              </table>
            </th>
          </tr>
          <tr>
            <th>Floor</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <td *ngFor="let i of schedulemethod">{{i.constructionrvalue.Floor}}
                  </td>
                </tr>
              </table>
            </th>
          </tr>
          <tr>
            <th>Skylights</th>
            <th>
              <table class="table table-sm table-bordered">
                <tr>
                  <td *ngFor="let i of schedulemethod">
                    {{i.constructionrvalue.Skylight}}
                  </td>
                </tr>
              </table>
            </th>
          </tr>
        </table>
      </div>


      <div class="col-md-12">
        <h1 style="text-align: center">Window to Wall Ratios</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Elevation</th>
            <th>Gross Wall Area</th>
            <th>Window Area</th>
            <th>Window to Wall Ratio</th>
          </tr>
          <tr>
            <td>North</td>
            <td>{{totalwallnorth | number: '1.0-2'}}</td>
            <td>{{totalwindownorth | number: '1.0-2'}}</td>
            <td>%{{(totalwindownorth/totalwallnorth) * 100 | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <td>South</td>
            <td>{{totalwallsouth | number: '1.0-2'}}</td>
            <td>{{totalwindowsouth | number: '1.0-2'}}</td>
            <td>%{{(totalwindowsouth/totalwallsouth) * 100 | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <td>East</td>
            <td>{{totalwalleast | number: '1.0-2'}}</td>
            <td>{{totalwindoweast | number: '1.0-2'}}</td>
            <td>%{{(totalwindoweast/totalwalleast) * 100 | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <td>West</td>
            <td>{{totalwallwest | number: '1.0-2'}}</td>
            <td>{{totalwindowwest | number: '1.0-2'}}</td>
            <td>%{{(totalwindowwest/totalwallwest) * 100 | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <td>E/W/S Only</td>
            <td>{{(totalwallsouth + totalwalleast + totalwallwest) | number: '1.0-2'}}</td>
            <td>{{(totalwindowsouth + totalwindoweast + totalwindowwest) | number: '1.0-2'}}</td>
            <td>
              %{{((totalwindowsouth + totalwindoweast + totalwindowwest) / (totalwallsouth + totalwalleast + totalwallwest)) * 100 | number: '1.0-2'}}
            </td>
          </tr>
          <tr>
            <td>All</td>
            <td>{{(totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) | number: '1.0-2'}}</td>
            <td>{{(totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) | number: '1.0-2'}}</td>
            <td>
              %{{((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)) * 100 | number: '1.0-2'}}
            </td>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <h1 style="text-align: center">Skylight Ratios</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Gross Roof Area</th>
            <th>Skylight Area</th>
            <th>Skylight Ratio</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr>
            <th>{{totalarearoof | number: '1.0-2'}}</th>
            <th>{{totalareaskylight | number: '1.0-2'}}</th>
            <th>%{{totalareaskylight / totalarearoof | number: '1.0-2'}}</th>
            <th>
              <img src="../../../assets/pic/pass.png" *ngIf="0.015 > (totalareaskylight / totalarearoof)">
              <img src="../../../assets/pic/fail.png" *ngIf="totalareaskylight / totalarearoof > 0.015">
            </th>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <h1 style="text-align: center">Door Area Allowance</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Gross Wall Area</th>
            <th>Door Area</th>
            <th>Max. Door Area Allowed</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr>
            <th>{{totalareawall | number: '1.0-2'}}</th>
            <th>{{totalareadoor | number: '1.0-2'}}</th>
            <th>{{maxdoorareaallow | number: '1.0-2'}}</th>
            <th>
              <img src="../../../assets/pic/pass.png" *ngIf="maxdoorareaallow > totalareadoor">
              <img src="../../../assets/pic/fail.png" *ngIf="totalareadoor > maxdoorareaallow">
            </th>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <h1 style="text-align: center">Proposed Construction R-values</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <th>Construction Element</th>
            <th>Proposed R-value</th>
            <th>Required R-value</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr>
            <td>Roof</td>
            <td>{{minrvalueroof}}</td>
            <td>{{roofrvalue}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="isroofpass">
              <img src="../../../assets/pic/fail.png" *ngIf="!isroofpass">
            </td>
          </tr>
          <tr>
            <td>Wall</td>
            <td>{{minrvaluewall}}</td>
            <td>{{wallrvalue}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="iswallpass">
              <img src="../../../assets/pic/fail.png" *ngIf="!iswallpass">
            </td>
          </tr>
          <tr>
            <td>Glazing</td>
            <td>{{minrvaluewindow}}</td>
            <td>{{windowrvalue}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="iswindowpass">
              <img src="../../../assets/pic/fail.png" *ngIf="!iswindowpass">
            </td>
          </tr>
          <tr>
            <td>Floor</td>
            <td>{{minrvaluefloor}}</td>
            <td>{{floorrvalue}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="isfloorpass">
              <img src="../../../assets/pic/fail.png" *ngIf="!isfloorpass">
            </td>
          </tr>
          <tr>
            <td>Skylight</td>
            <td>{{minrvalueskylight}}</td>
            <td>{{skylightrvalue}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="isskylightpass">
              <img src="../../../assets/pic/fail.png" *ngIf="!isskylightpass">
            </td>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <table class="table table-sm table-bordered">
          <tr>
            <th>Homestar Compliance Requirements</th>
            <th>Result</th>
            <th>Homestar Compliance</th>
          </tr>
          <tr>
            <td>The glazing area is 30% or less of the total wall area</td>
            <td>
              %{{((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)) * 100 | number: '1.0-2'}}
            </td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="0.30 >= ((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth))">
              <img src="../../../assets/pic/fail.png"
                *ngIf="((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)) > 0.30">
            </td>
          </tr>
          <tr>
            <td>The glazing area on the E, S and W facing walls is 30% or less of the wall area of these walls</td>
            <td>
              %{{((totalwindowsouth + totalwindoweast + totalwindowwest) / (totalwallsouth + totalwalleast + totalwallwest)) * 100 | number: '1.0-2'}}
            </td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="0.30 >= ((totalwindowsouth + totalwindoweast + totalwindowwest) / (totalwallsouth + totalwalleast + totalwallwest))">
              <img src="../../../assets/pic/fail.png"
                *ngIf="((totalwindowsouth + totalwindoweast + totalwindowwest) / (totalwallsouth + totalwalleast + totalwallwest)) > 0.30">
            </td>
          </tr>
          <tr>
            <td>The area of all skylights is less than 1.5% of the exposed roof area</td>
            <td>%{{totalareaskylight / totalarearoof | number: '1.0-2'}}</td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="0.015 > (totalareaskylight / totalarearoof)">
              <img src="../../../assets/pic/fail.png" *ngIf="(totalareaskylight / totalarearoof) > 0.015">
            </td>
          </tr>
          <tr>
            <td>All of the building construction elements achieve the required final R-values</td>
            <td>{{isroofpass && iswallpass && isskylightpass && isfloorpass && iswindowpass ? "Yes" : "No"}}</td>
            <td>
              <img src="../../../assets/pic/pass.png"
                *ngIf="isroofpass && iswallpass && isskylightpass && isfloorpass && iswindowpass">
              <img src="../../../assets/pic/fail.png"
                *ngIf="!(isroofpass && iswallpass && isskylightpass && isfloorpass && iswindowpass)">
            </td>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <h1 style="text-align: center">EHC-1 Schedule Method by Calculation (using NZS 4218:2009)</h1>
        <table class="table table-sm table-bordered">
          <tr>
            <td>Result</td>
            <td>
              <span *ngIf="totalschedule >= totalproposed">
                The Building Complies with the Homestar Schedule Method by Calculation when using NZS 4218:2009
              </span>
              <span *ngIf="totalproposed > totalschedule">
                The Building Does Not Comply with the Homestar Schedule Method by Calculation when using NZS 4218:2009
              </span>
            </td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="totalschedule >= totalproposed">
              <img src="../../../assets/pic/fail.png" *ngIf="totalproposed > totalschedule">
            </td>
          </tr>
        </table>
      </div>

      <div class="col-md-12">
        <table class="table table-sm table-bordered">
          <tr>
            <th>Proposed</th>
            <th>Reference</th>
          </tr>
          <tr>
            <th>Total Heat Loss (Proposed Dwelling)</th>
            <th>Total Heat Loss (Reference Dwelling)</th>
          </tr>
          <tr>
            <td>
              <table class="table table-sm table-bordered">
                <tr>
                  <td>#</td>
                  <td>Area</td>
                  <td>R-Value</td>
                  <td>Heatloss</td>
                </tr>
                <tr>
                  <td>Roof</td>
                  <td>{{totalarearoof | number: '1.0-2'}}</td>
                  <td>{{totalarearoof / totalheatlossroof | number: '1.0-2'}}</td>
                  <td>{{totalheatlossroof | number: '1.0-2'}}</td>
                </tr>
                <tr>
                  <td>Skylight</td>
                  <td>{{totalareaskylight | number: '1.0-2'}}</td>
                  <td>
                    {{totalareaskylight / totalheatlossskylight ? (totalareaskylight / totalheatlossskylight) : 0 | number: '1.0-2'}}
                  </td>
                  <td>{{totalheatlossskylight | number: '1.0-2'}}</td>
                </tr>
                <tr>
                  <td>Wall</td>
                  <td>{{totalareawall | number: '1.0-2'}}</td>
                  <td>{{totalareawall / totalheatlosswall | number: '1.0-2'}}</td>
                  <td>{{totalheatlosswall | number: '1.0-2'}}</td>
                </tr>
                <tr>
                  <td>Door</td>
                  <td>{{totalareadoor | number: '1.0-2'}}</td>
                  <td>
                    <span
                      *ngIf="maxdoorareaallow > totalareadoor">{{totalareawall / totalheatlosswall | number: '1.0-2'}}</span>
                    <span
                      *ngIf="totalareadoor > maxdoorareaallow">{{totalareadoor / totalheatlossdoor | number: '1.0-2'}}</span>
                  </td>
                  <td>
                    <span
                      *ngIf="maxdoorareaallow > totalareadoor">{{(totalareadoor/(totalareawall / totalheatlosswall)) | number: '1.0-2'}}</span>
                    <span
                      *ngIf="totalareadoor > maxdoorareaallow">{{totalareadoor / totalheatlossdoor | number: '1.0-2'}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Windows</td>
                  <td>{{totalareawindow | number: '1.0-2'}}</td>
                  <td>{{totalareawindow / totalheatlosswindow | number: '1.0-2'}}</td>
                  <td>{{totalheatlosswindow | number: '1.0-2'}}</td>
                </tr>
                <tr>
                  <td>Floor</td>
                  <td>{{totalareafloor | number: '1.0-2'}}</td>
                  <td>{{totalareafloor / totalheatlossfloor | number: '1.0-2'}}</td>
                  <td>{{totalheatlossfloor | number: '1.0-2'}}</td>
                </tr>
              </table>
            </td>
            <td>
              <table class="table table-sm table-bordered">
                <tr>
                  <td>#</td>
                  <td>Area</td>
                  <td>R-Value</td>
                  <td>Heatloss</td>
                </tr>
                <tr>
                  <td>Roof</td>
                  <td>{{totalarearoof | number: '1.0-2'}}</td>
                  <td>{{roofrvalue | number: '1.0-2'}}</td>
                  <td>{{totalarearoof / roofrvalue | number: '1.0-2'}}</td>
                </tr>
                <tr>
                  <td>Skylight</td>
                  <td>{{totalareaskylight | number: '1.0-2'}}</td>
                  <td>
                    <span
                      *ngIf="0.015 > (totalareaskylight / totalarearoof)">{{skylightrvalue | number: '1.0-2'}}</span>
                    <span *ngIf="(totalareaskylight / totalarearoof) > 0.015">{{roofrvalue | number: '1.0-2'}}</span>
                    <span *ngIf="skylightlist.length == 0">-</span>
                  </td>
                  <td>
                    <span
                      *ngIf="0.015 > (totalareaskylight / totalarearoof)">{{totalareaskylight/skylightrvalue | number: '1.0-2'}}</span>
                    <span
                      *ngIf="(totalareaskylight / totalarearoof) > 0.015">{{totalareaskylight/roofrvalue | number: '1.0-2'}}</span>
                    <span *ngIf="skylightlist.length == 0">-</span>
                  </td>
                </tr>
                <tr>
                  <td>Wall</td>
                  <td>
                    <span
                      *ngIf="0.30 > (totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)">{{((totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) * 0.7) |  number: '1.0-2'}}</span>
                    <span
                      *ngIf="(totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) > 0.30">{{totalareawall | number: '1.0-2'}}</span>
                  </td>
                  <td>{{wallrvalue | number: '1.0-2'}}</td>
                  <td>
                    <span
                      *ngIf="0.30 > (totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)">{{(((totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) * 0.7) / wallrvalue) | number: '1.0-2'}}</span>
                    <span
                      *ngIf="(totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) > 0.30">{{(totalareawall / wallrvalue) | number: '1.0-2'}}</span>
                  </td>
                </tr>
                <tr>
                  <td>Windows & Door (< %30)</td> <td>{{totalareawindowless30 | number: '1.0-2'}}</td>
                  <td>{{windowrvalue | number: '1.0-2'}}</td>
                  <td>{{totalareawindowless30/windowrvalue | number: '1.0-2'}} </td>
                </tr>
                <tr>
                  <td>Windows & Door (> %30)</td>
                  <td>{{totalareawindowmore30 | number: '1.0-2'}}</td>
                  <td>
                    <span
                      *ngIf="(totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) > 0.30">
                      {{wallrvalue | number: '1.0-2'}}</span>
                    <span
                      *ngIf="0.30 > (totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)">-</span>
                  </td>
                  <td>
                    <span
                      *ngIf="(totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) > 0.30">{{totalareawindowmore30/wallrvalue | number: '1.0-2'}}</span>
                    <span
                      *ngIf="0.30 > (totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)">
                      - </span>
                  </td>
                </tr>
                <tr>
                  <td>Floor</td>
                  <td>{{totalareafloor | number: '1.0-2'}}</td>
                  <td>{{floorrvalue | number: '1.0-2'}}</td>
                  <td>{{totalareafloor/floorrvalue | number: '1.0-2'}}</td>
                </tr>
              </table>
            </td>
          </tr>
          <tr>
            <td>Total Heat Loss in Proposed: {{totalproposed | number: '1.0-2'}}</td>
            <td>Total Heat Loss in Schedule: {{totalschedule | number: '1.0-2'}}</td>
          </tr>
          <tr>
            <td>Result: </td>
            <td>
              <img src="../../../assets/pic/pass.png" *ngIf="totalschedule >= totalproposed">
              <img src="../../../assets/pic/fail.png" *ngIf="totalproposed > totalschedule">
            </td>
          </tr>
        </table>
      </div>
      <table class="table table-sm table-bordered">
        <tr>
          <td>Wall Balance Check (Proposed):</td>
          <td>{{totalareawall + totalareawindow + totalareadoor | number: '1.0-2'}}</td>
          <td>Wall Balance Check (Reference)</td>
          <td>
            <span
              *ngIf="0.30 > ((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth))">
              {{(((totalwallsouth + totalwalleast + totalwallwest + totalwallnorth) * 0.7) + totalareawindowless30 + totalareawindowmore30) | number: '1.0-2'}}
            </span>
            <span
              *ngIf="((totalwindowsouth + totalwindoweast + totalwindowwest + totalwindownorth) / (totalwallsouth + totalwalleast + totalwallwest + totalwallnorth)) > 0.30">
              {{(totalareawall + totalareawindowless30 + totalareawindowmore30) | number: '1.0-2'}}
            </span>
          </td>
        </tr>
      </table>
    </div>
  </div>

</div>